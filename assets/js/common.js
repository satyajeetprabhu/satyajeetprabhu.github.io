/**
 * Common JavaScript for Satyajeet Prabhu Website
 * Handles all shared elements across pages
 */

(function() {
    'use strict';
    
    // Configuration object for all shared elements
    const siteConfig = {
        // Header
        logo: 'SATYAJEET PRABHU',
        
        // Social links
        social: {
            linkedin: {
                url: 'https://www.linkedin.com/in/satyajeet-prabhu/',
                label: 'LinkedIn Profile'
            },
            email: {
                url: 'mailto:satyajeetprabhu@gmail.com',
                label: 'Send Email'
            }
        },
        
        // Footer
        copyright: 'Â© 2025 Satyajeet Prabhu. All rights reserved.',
        
        // Scripts
        scripts: [
            'assets/js/navigation.js',
            'assets/js/interactions.js'
        ]
    };
    
    // Shared body reference
    const body = document.body;
    
    // Generate skip navigation
    function generateSkipNav() {
        const skipNav = document.createElement('a');
        skipNav.href = '#main-content';
        skipNav.className = 'skip-nav';
        skipNav.textContent = 'Skip to main content';
        body.insertBefore(skipNav, body.firstChild);
    }
    
    // Generate header
    function generateHeader() {
        const header = document.createElement('header');
        header.className = 'hero';
        
        header.innerHTML = `
            <nav class="nav" role="navigation" aria-label="Main navigation">
                <div class="container">
                    <div class="nav-content">
                        <div class="logo">${siteConfig.logo}</div>
                        <ul class="nav-menu" role="menubar">
                            <!-- Navigation will be generated by navigation.js -->
                        </ul>
                        <button class="hamburger" id="hamburger" aria-label="Open mobile menu" aria-expanded="false">
                            <span></span>
                            <span></span>
                            <span></span>
                        </button>
                    </div>
                </div>
            </nav>
            <div class="hero-content">
                <h1 class="hero-title" id="page-title">PAGE TITLE</h1>
            </div>
        `;
        
        body.insertBefore(header, body.firstChild);
    }
    
    // Generate mobile navigation
    function generateMobileNav() {
        const mobileNav = document.createElement('nav');
        mobileNav.className = 'mobile-nav';
        mobileNav.id = 'mobile-nav';
        mobileNav.setAttribute('role', 'navigation');
        mobileNav.setAttribute('aria-label', 'Mobile navigation');
        
        mobileNav.innerHTML = `
            <button class="close-menu" id="close-menu" aria-label="Close mobile menu">&times;</button>
            <ul role="menu">
                <!-- Navigation will be generated by navigation.js -->
            </ul>
        `;
        
        const overlay = document.createElement('div');
        overlay.className = 'mobile-nav-overlay';
        overlay.id = 'mobile-nav-overlay';
        
        const header = document.querySelector('.hero');
        if (header) {
            header.parentNode.insertBefore(mobileNav, header.nextSibling);
            header.parentNode.insertBefore(overlay, mobileNav.nextSibling);
        }
    }
    
    // Generate social links
    function generateSocialLinks() {
        const aside = document.createElement('aside');
        aside.className = 'social-links';
        aside.setAttribute('aria-label', 'Social media links');
        
        aside.innerHTML = `
            <span class="wsite-social wsite-social-default">
                <a class="wsite-social-item wsite-social-linkedin" href="${siteConfig.social.linkedin.url}" target="_blank" rel="noopener noreferrer" aria-label="${siteConfig.social.linkedin.label}">
                    <span class="wsite-social-item-inner"></span>
                </a>
                <a class="wsite-social-item wsite-social-mail" href="${siteConfig.social.email.url}" aria-label="${siteConfig.social.email.label}">
                    <span class="wsite-social-item-inner"></span>
                </a>
            </span>
        `;
        
        const overlay = document.getElementById('mobile-nav-overlay');
        if (overlay) {
            overlay.parentNode.insertBefore(aside, overlay.nextSibling);
        }
    }
    
    // Generate footer
    function generateFooter() {
        const footer = document.createElement('footer');
        footer.className = 'footer';
        footer.setAttribute('role', 'contentinfo');
        
        footer.innerHTML = `
            <div class="container">
                <p>${siteConfig.copyright}</p>
            </div>
        `;
        
        body.appendChild(footer);
    }
    
    // Set page title
    function setPageTitle() {
        const currentPage = window.location.pathname.split('/').pop() || 'index.html';
        const pageTitleMap = {
            'index.html': 'ABOUT',
            'work.html': 'WORK',
            'music.html': 'MUSIC',
            'tech.html': 'ACADEMIC & TECH'
        };
        
        const pageTitle = pageTitleMap[currentPage] || 'PAGE';
        const titleElement = document.getElementById('page-title');
        if (titleElement) {
            titleElement.textContent = pageTitle;
        }
    }
    
    // Load scripts after DOM is ready
    function loadScripts() {
        // Load navigation.js first
        const navScript = document.createElement('script');
        navScript.src = 'assets/js/navigation.js';
        navScript.onload = function() {
            // Populate navigation immediately after navigation.js loads
            if (window.generateNavigation) {
                const currentPage = window.location.pathname.split('/').pop() || 'index.html';
                
                const desktopNav = document.querySelector('.nav-menu');
                if (desktopNav) {
                    desktopNav.innerHTML = window.generateNavigation(currentPage);
                }
                
                const mobileNav = document.querySelector('.mobile-nav ul');
                if (mobileNav) {
                    mobileNav.innerHTML = window.generateNavigation(currentPage);
                }
            }
            
            // Then load interactions.js
            const interactionsScript = document.createElement('script');
            interactionsScript.src = 'assets/js/interactions.js';
            body.appendChild(interactionsScript);
        };
        body.appendChild(navScript);
    }
    
    // Initialize everything
    function init() {
        generateSkipNav();
        generateHeader();
        generateMobileNav();
        generateSocialLinks();
        generateFooter();
        setPageTitle();
        loadScripts();
    }
    
    // Run when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }
    
})(); 